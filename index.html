<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>EGR Staff Hub — Sign In</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<meta name="theme-color" content="#111"/>
<style>
  :root{
    --bg:#0b0b0b; --panel:#141414; --line:#2a2a2a; --text:#fff; --muted:#cfcfcf;
    --red:#d71920; --red2:#a31318; --offwhite:#f6f6f6;
  }
  *{box-sizing:border-box} html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial,sans-serif}

  /* BG carousel (uses your filenames exactly) */
  .stage{position:relative;min-height:100vh;display:grid;place-items:center;overflow:hidden}
  .slides{position:absolute;inset:0;z-index:0}
  .slides img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .9s ease;filter:brightness(.45)}
  .slides img.show{opacity:1}
  .tint{position:absolute;inset:0;background:
        radial-gradient(60% 50% at 50% 30%, rgba(255,255,255,.08), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.55));
        z-index:0}

  /* Brand bar */
  .brandbar{position:absolute;top:14px;left:50%;transform:translateX(-50%);z-index:2;color:var(--offwhite);
            display:flex;gap:10px;align-items:center;font-weight:800;letter-spacing:.02em}
  .brandbar .logo{width:26px;height:26px;background:#fff;border-radius:6px;
    -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M3 26 L26 26 L38 18 L44 18 L44 34 L38 34 L26 26 L3 26 L1 28 L1 24 Z" fill="black"/></svg>') center/contain no-repeat;
            mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M3 26 L26 26 L38 18 L44 18 L44 34 L38 34 L26 26 L3 26 L1 28 L1 24 Z" fill="black"/></svg>') center/contain no-repeat;}

  /* Card */
  .wrap{position:relative;z-index:2;width:min(1100px,92vw);margin:auto;padding:16px}
  .card{margin:10vh auto 24px;max-width:540px;background:rgba(0,0,0,.55);
        border:1px solid rgba(255,255,255,.08);backdrop-filter:blur(10px);
        border-radius:18px;padding:22px;box-shadow:0 30px 80px rgba(0,0,0,.45);display:grid;gap:14px}
  h1{margin:.2rem 0 0;font-size:clamp(28px,5vw,40px);font-weight:900}
  .lead{color:#ddd;margin:0 0 6px}
  label{display:grid;gap:6px;margin-top:6px}
  input{background:#101010;color:#fff;border:1px solid #2c2c2c;border-radius:12px;padding:12px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
  .btn{cursor:pointer;border-radius:12px;padding:12px 16px;border:1px solid #2c2c2c;background:#181818;color:#fff}
  .btn.primary{border-color:var(--red);background:linear-gradient(180deg,var(--red),var(--red2))}
  .btn.ghost{background:transparent}
  .actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
  .links{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
  .linkbtn{border:1px solid rgba(255,255,255,.14);padding:8px 12px;border-radius:999px;background:rgba(0,0,0,.35)}
  .status{min-height:20px}
  .error{color:#ffb3b3}.ok{color:#b7ffcf}.muted{color:#cfcfcf}
  .foot{color:#bbb;text-align:center;font-size:.9rem}
  .foot a{color:#fff}
</style>
</head>
<body>
<main class="stage">
  <!-- Backgrounds using your EXACT filenames at repo root -->
  <div class="slides" id="slides"></div>
  <div class="tint"></div>

  <div class="brandbar"><div class="logo"></div> Emirates Group Roblox — Staff Hub</div>

  <div class="wrap">
    <section class="card">
      <h1>Sign in</h1>
      <p class="lead">Welcome back. Use your staff email and access code.</p>

      <label>Email
        <input id="email" type="email" placeholder="you@egr.staff">
      </label>

      <label>Access code
        <input id="code" type="password" placeholder="••••••••">
      </label>

      <div class="row">
        <label style="display:flex;align-items:center;gap:8px">
          <input id="remember" type="checkbox" style="width:18px;height:18px"> Remember me
        </label>
        <button id="loginBtn" class="btn primary">Sign In</button>
      </div>

      <div id="status" class="status muted"></div>

      <div class="actions">
        <a class="btn ghost" href="https://careers.emiratesgrouproblox.link" target="_blank" rel="noopener">Careers Site</a>
        <a class="btn ghost" href="https://emiratesgrouproblox.link" target="_blank" rel="noopener">Main Website</a>
        <a class="btn" style="border-color:#5865F2;background:#5865F2" href="https://discord.com/channels/1189224375019388999" target="_blank" rel="noopener">Contact HR on Discord</a>
      </div>
      <div class="links">
        <span class="linkbtn">Secure</span>
        <span class="linkbtn">Private</span>
        <span class="linkbtn">Role-based</span>
      </div>
    </section>

    <p class="foot">Having trouble? Ask HR to confirm your <em>email</em> and <em>access code</em> in the Staff Hub sheet.</p>
  </div>
</main>

<script>
/* ===== CONFIG ===== */
const API_URL = "YOUR_APPS_SCRIPT_URL"; // <-- paste your /exec URL

/* Use your EXACT filenames at the repo root. We URL-encode spaces safely. */
const BG_NAMES = [
  "EGR Flight Pic 350.png",
  "EGR Flight Pic 380.png",
  "EK 707 group pic.png"
];

/* ===== BG carousel that respects spaces in filenames ===== */
const slides = document.getElementById('slides');
const urls = BG_NAMES.map(n => n.split('/').map(encodeURIComponent).join('/')); // keep names, just encode spaces
const imgs = urls.map(u => { const im=new Image(); im.src=u; slides.appendChild(im); return im; });
let ix=0; function show(i){ imgs.forEach((im,k)=>im.classList.toggle('show',k===i)); }
imgs[0].onload=()=>show(0); setInterval(()=>{ ix=(ix+1)%imgs.length; show(ix); }, 4200);

/* ===== Helpers ===== */
const $ = s=>document.querySelector(s);
const statusEl = $("#status");
function setStatus(m, cls="muted"){ statusEl.textContent=m||""; statusEl.className="status "+cls; }
function loading(on){ $("#loginBtn").disabled=!!on; $("#loginBtn").textContent=on?"Signing in…":"Sign In"; }
(function rememberLoad(){ const s=localStorage.getItem("egr_email"); if(s){ $("#email").value=s; $("#remember").checked=true; } })();

/* ===== JSONP (no CORS) ===== */
function jsonp(method, params, cb){
  const callback = "cb_"+Math.random().toString(36).slice(2);
  const q = new URLSearchParams({ method, callback, ...params });
  const s = document.createElement("script");
  s.src = API_URL + "?" + q.toString();
  window[callback] = (resp)=>{ cb(resp); document.body.removeChild(s); delete window[callback]; };
  s.onerror = ()=>{ cb({ ok:false, error:"Network error" }); document.body.removeChild(s); delete window[callback]; };
  document.body.appendChild(s);
}

/* ===== Login ===== */
function doLogin(){
  const email = $("#email").value.trim();
  const code  = $("#code").value.trim();
  if(!email || !code){ setStatus("Please enter email and access code.","error"); return; }
  setStatus(""); loading(true);
  jsonp("login",{email,code},(r)=>{
    loading(false);
    if(!r?.ok){ setStatus(r?.error||"Login failed","error"); return; }
    localStorage.setItem("egr_token", r.token);
    localStorage.setItem("egr_profile", JSON.stringify(r.profile));
    if($("#remember").checked) localStorage.setItem("egr_email", email); else localStorage.removeItem("egr_email");
    setStatus("Signed in — redirecting…","ok");
    window.location.href="/dashboard.html";
  });
}
$("#loginBtn").onclick=doLogin;
["email","code"].forEach(id=>document.getElementById(id).addEventListener("keydown",(e)=>{ if(e.key==="Enter"){e.preventDefault();doLogin();} }));
</script>
</body>
</html>